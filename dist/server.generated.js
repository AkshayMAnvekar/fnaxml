module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(n,l,function(t){return e[t]}.bind(null,l));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=4)}([function(e,t){e.exports=require("xlsx")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("excel4node")},function(e,t){e.exports=require("string-similarity")},function(e,t,r){r(5),e.exports=r(6)},function(e,t){e.exports=require("babel-polyfill")},function(e,t,r){const n=r(7),l=r(8),o=r(9),a=(r(10),r(0),r(11)),i=r(12);var s=a.memoryStorage(),c=a({storage:s}).single("userPhoto");const u=n();u.use(o.urlencoded({extended:!1})),u.use(o.json());const p=process.cwd();u.use(n.static(l.join(p,"public"))),u.get("/test",(e,t)=>{t.send("My page")}),u.get("/test1",(e,t)=>{t.send("My page 2")}),u.get("/getfile1",(e,t)=>{console.log(e.query),t.send("My page 2")}),u.post("/getfile",(e,t)=>{c(e,t,(async function(r){if(r)return t.end("Error uploading file.");console.log("Call");var n=await i(`${e.file.originalname}`);return console.log("Result",n),t.download(n)}))}),u.get("*",(e,t)=>{t.send("My web page")});const d=process.env.PORT||3e3;u.listen(d)},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("formidable")},function(e,t){e.exports=require("multer")},function(e,t,r){const n=r(1),l=r(13),o=(r(2),r(14)),a=(r(15),r(0)),i=(r(3),r(16));var s=2;async function c(e){return new Promise(t=>setTimeout(t,e))}async function u(e,t){var r=a.readFile("Extracted.xlsx"),o=r.Sheets["Extracted Data"];console.log(e);var i=new l.Parser;n.readFile(e,(async function(e,t){i.parseString(t,(async function(e,t){let l=JSON.stringify(t,null,2);n.writeFileSync("xml.json",l),n.writeFileSync("xml.txt",t),t.questionSet.question.forEach((async function(e){var t={LO:"",topic:"",AACSB:"",BB:"",FN:"",blooms:"",difficulty:"",time:"",type:"",gradable:"",qtype:"",LODescription:""};t.title=e.title.toString();var r=e.questionProperties[0];for(individualProperty of r.property)"customType"===individualProperty.$.name&&(t.qtype+=individualProperty.$.value);e.categories.forEach((function(e){e.internal_category.forEach((function(e){var r=e.title.toString();r.includes("Learning Objective:")&&(""!==t.LO&&(t.LO+=", "),t.LO+=r.replace(/(.*)(\d{2,3})(-)(\d{2,3})(.*)/g,"$2$3$4")),r.includes("Learning Objective:")&&(""!==t.LODescription&&(t.LODescription+=";"),t.LODescription+=r.replace(/(.*)(\d{2,3})(-)(\d{2,3})(.*)/g,"$2$3$4 $5")),r.includes("Topic:")&&(""!==t.topic&&(t.topic+=", "),t.topic+=r.replace(/Topic: /g,"")),r.includes("AACSB:")&&(""!==t.AACSB&&(t.AACSB+=", "),t.AACSB+=r.replace(/AACSB: /g,"")),r.includes("AICPA: BB")&&(""!==t.BB&&(t.BB+=", "),t.BB+=r.replace(/AICPA: BB /g,"")),r.includes("AICPA: FN")&&(""!==t.FN&&(t.FN+=", "),t.FN+=r.replace(/AICPA: FN /g,"")),r.includes("Blooms:")&&(""!==t.blooms&&(t.blooms+=", "),t.blooms+=r.replace(/Blooms: /g,"")),r.includes("Difficulty:")&&(""!==t.difficulty&&(t.difficulty+=", "),t.difficulty+=r.replace(/Difficulty: /g,"")),r.includes("Est Time:")&&(""!==t.time&&(t.time+=", "),t.time+=r.replace(/Est Time: /g,"")),r.includes("Type:")&&(""!==t.type&&(t.type+=", "),t.type+=r.replace(/Type: /g,"")),r.includes("Gradable:")&&(""!==t.gradable&&(t.gradable+=", "),t.gradable+=r.replace(/Gradable: /g,""))}))}));var n=[[`${t.title}`,`${t.LO}`,`${t.topic}`,`${t.AACSB}`,`${t.BB}`,`${t.FN}`,`${t.blooms}`,`${t.difficulty}`,`${t.time}`,`${t.type}`,`${t.qtype}`,`${t.gradable}`,`${t.LODescription}`]];a.utils.sheet_add_aoa(o,n,{origin:`A${s}`}),s++})),await a.writeFile(r,"Extracted.xlsx"),console.log("Done")}))})),t("./Comparison.xlsx")}e.exports=async function(e){var t=new o(e).getEntries();for await(const e of t){if(await c(2e3),console.log(e.entryName),"xlsx"==e.entryName.split(".").pop()){var r=a.readFile(e.entryName),l=r.SheetNames[0],s=r.Sheets[l],p=a.readFile("ExcelTemplate.xlsx");a.utils.book_append_sheet(p,s,l);var d=r.SheetNames[1],f=r.Sheets[d];await a.writeFile(p,"Extracted.xlsx");p=a.readFile("Extracted.xlsx");a.utils.book_append_sheet(p,f,d);let t=JSON.stringify(a.utils.sheet_to_json(s),null,2);n.writeFileSync("PM.json",t),await a.writeFile(p,"Extracted.xlsx")}"xml"==e.entryName.split(".").pop()&&await u(e.entryName,(function(e){console.log(e)}))}await c(2e3),await i("Extracted.xlsx"),await c(2e3);var g=new o;return g.addLocalFile("./Comparison.xlsx"),g.addLocalFile("./Extracted.xlsx"),g.writeZip("./Output.zip"),await c(2e3),"./Output.zip"}},function(e,t){e.exports=require("xml2js")},function(e,t){e.exports=require("adm-zip")},function(e,t){e.exports=require("exceljs")},function(e,t,r){const n=r(0),l=r(3),o=(r(1),r(2));function a(e){var t=e.split(" ");return t[t.length-1]}function i(e){return/\d/g.test(e)}function s(e,t){var r={};t=(t=t.replace(/  +/g,",")).replace("\r\n",","),e=e.trim(),t=t.trim();var n=e.split(/[,;]/g).sort(),o=t.split(/[,;]/g).sort();n=n.filter(Boolean),o=o.filter(Boolean);for(var a=0;a<n.length;a++)n[a]=n[a].trim();for(a=0;a<n.length;a++)o[a]=o[a].trim();return n=n.sort(),o=o.sort(),r.extract=n.toString(),r.PM=o.toString(),r.Result=l.compareTwoStrings(n.toString(),o.toString()),r}function u(e,t){return s(e,t)}function p(e,t){return s(e,t)}function f(e,t){return s(e,t)}function g(e,t){return s(e,t)}function x(e,t){return s(e,t)}function y(e,t){var r=e.toUpperCase(),n=t.toUpperCase(),l={};return l.extract=r,l.PM=n,l.Result=1,r.includes("ESSAY")&&n.includes("AUTO")&&(l.Result=0),l}function m(e,t){var r=e.charAt(0);r=r.toUpperCase();var n=t.toUpperCase(),l={};return l.extract=r,l.PM=n,l.Result=0,"B"===n?"S"!==r&&"A"!==r||(l.Result=1):r===n&&(l.Result=1),l}function $(e,t){var r=e,n=t;return i(r)&&(r=a(r)),i(n)&&(n=a(n)),s(r,n)}function h(e,t){var r=e,n={extract:"",PM:"",Result:0};if(e.includes(";")){var l=r.split(/[;]/g).sort();for(var o of(console.log("Mul"),l))for(var a of t)if(c=o,d=a.LODescription,console.log("mul",o),c===d){var i=s(o,a.LODescription.replace(/\s{2,}/g," "));""!==n.extract&&(n.extract+=", "),""!==n.PM&&(n.PM+=", "),n.extract+=i.extract,n.PM+=i.PM,n.Result=(n.Result+i.Result)/2}}else for(var a of t)console.log("Sin",e),e.replace(/(.*)(\d{2,3})(-)(\d{2,3})(.*)/g,"$2$3$4")===a.LODescription.replace(/(.*)(\d{2,3})(-)(\d{2,3})(.*)/g,"$2$3$4")&&(n=s(e,a.LODescription.replace(/\s{2,}/g," "))),console.log(a,typeof a);return n}function M(e,t){var r=e,n=t;return i(r)&&(r=a(r)),i(n)&&(n=a(n)),s(r,n)}function b(e,t){var r=e.match(/(\d{1,3})/g),n=t.match(/(\d{1,3})/g),l={};return l.extract=e,l.PM=t,r.length>1&&n.length>1?r[r.length-1]===n[n.length-1]&&r[0]===n[0]?l.Result=1:l.Result=0:l.Result=parseInt(r[r.length-1])===parseInt(n[n.length-1])?1:0,l}e.exports=async function(e){var t,r,l,a,i=new o.Workbook,c=i.createStyle({font:{color:"#000000",size:12},numberFormat:"$#,##0.00; ($#,##0.00); -"}),d=i.createStyle({font:{color:"#000000",size:12},fill:{type:"pattern",patternType:"solid",fgColor:"#FF0000"},numberFormat:"$#,##0.00; ($#,##0.00); -"}),R=i.createStyle({font:{color:"#000000",size:12},fill:{type:"pattern",patternType:"solid",fgColor:"#FFA500"},numberFormat:"$#,##0.00; ($#,##0.00); -"}),P=i.addWorksheet("Comparison Result",{sheetFormat:{defaultColWidth:30}}),v=n.readFile("Extracted.xlsx"),S=v.Sheets["Extracted Data"],D=n.utils.sheet_to_json(S),B=v.Sheets.Sheet1,A=v.Sheets.Sheet2,E=n.utils.sheet_to_json(B),O=n.utils.sheet_to_json(A),F=2;for(let e of D){e.Q=e.Q.replace(/\[(.*)\]/g,"");var w=e.Q.match(/(\d{1,2}-\d{1,3})/g);w[0]=w[0].replace(/\b0+/g,"");for(let n of E){var C=n.Q.match(/(\d{1,2}-\d{1,3})/g);if(w[0]===C[0]){var T=(t=e.LO,r=n.LO,l=void 0,a=void 0,l=t.match(/(\d{1,2}-\d{1,3})/g),a=r.match(/(\d{1,2}-\d{1,3})/g),s(l.toString(),a.toString())),L=u(e.Topic,n.Topic),_=p(e.AACSB,n.AACSB),q=f(e.BB,n.BB),j=g(e.FN,n.FN),N=$(e.Blooms,n.Blooms),k=M(e.Difficulty,n.Difficulty),z=b(e.Time,n.Time),I=m(e.Type,n.Type),W=x(e.Worksheet,n.Worksheet),Q=y(e.Gradable,n.Worksheet),U=h(e.LODescription,O);P.cell(F,1).string(e.Q).style(c),P.cell(F,2).string(`Extracted Data: ${T.extract}\r\nProblem Map Data: ${T.PM}\r\nMatch: ${T.Result}`).style(1===T.Result?c:T.Result>=.95?R:d),P.cell(F,3).string(`Extracted Data: ${L.extract}\r\nProblem Map Data: ${L.PM}\r\nMatch: ${L.Result}`).style(1===L.Result?c:L.Result>=.95?R:d),P.cell(F,4).string(`Extracted Data: ${_.extract}\r\nProblem Map Data: ${_.PM}\r\nMatch: ${_.Result}`).style(1===_.Result?c:_.Result>=.95?R:d),P.cell(F,5).string(`Extracted Data: ${q.extract}\r\nProblem Map Data: ${q.PM}\r\nMatch: ${q.Result}`).style(1===q.Result?c:q.Result>=.95?R:d),P.cell(F,6).string(`Extracted Data: ${j.extract}\r\nProblem Map Data: ${j.PM}\r\nMatch: ${j.Result}`).style(1===j.Result?c:j.Result>=.95?R:d),P.cell(F,7).string(`Extracted Data: ${N.extract}\r\nProblem Map Data: ${N.PM}\r\nMatch: ${N.Result}`).style(1===N.Result?c:N.Result>=.95?R:d),P.cell(F,8).string(`Extracted Data: ${k.extract}\r\nProblem Map Data: ${k.PM}\r\nMatch: ${k.Result}`).style(1===k.Result?c:k.Result>=.95?R:d),P.cell(F,9).string(`Extracted Data: ${z.extract}\r\nProblem Map Data: ${z.PM}\r\nMatch: ${z.Result}`).style(1===z.Result?c:z.Result>=.95?R:d),P.cell(F,10).string(`Extracted Data: ${I.extract}\r\nProblem Map Data: ${I.PM}\r\nMatch: ${I.Result}`).style(1===I.Result?c:I.Result>=.95?R:d),P.cell(F,11).string(`Extracted Data: ${W.extract}\r\nProblem Map Data: ${W.PM}\r\nMatch: ${W.Result}`).style(1===W.Result?c:W.Result>=.95?R:d),P.cell(F,12).string(`Extracted Data: ${Q.extract}\r\nProblem Map Data: ${Q.PM}\r\nMatch: ${Q.Result}`).style(1===Q.Result?c:Q.Result>=.95?R:d),P.cell(F,13).string(`Extracted Data: ${U.extract}\r\nProblem Map Data: ${U.PM}\r\nMatch: ${U.Result}`).style(1===U.Result?c:U.Result>=.95?R:d)}}F++}console.log("Comp St"),i.write("./Comparison.xlsx"),console.log("Comp End")}}]);