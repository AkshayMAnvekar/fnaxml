module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=11)}([function(e,t){e.exports=require("xlsx")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("excel4node")},function(e,t){e.exports=require("string-similarity")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("multer")},function(e,t){e.exports=require("adm-zip")},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("xml2js")},function(e,t,r){r(12),e.exports=r(13)},function(e,t){e.exports=require("babel-polyfill")},function(e,t,r){"use strict";r.r(t);var n=r(4),a=r.n(n),o=r(9),i=r.n(o),l=r(5),c=r.n(l),s=(r(14),r(0),r(6)),u=r.n(s);r(15).pd;var f=r(16),p=u.a.memoryStorage(),d=u()({storage:p}).single("userPhoto");const x=a()();x.use(c.a.urlencoded({extended:!1})),x.use(c.a.json());const g=process.cwd();x.use(a.a.static(i.a.join(g,"public"))),x.get("/test",(e,t)=>{t.send("My page")}),x.get("/test1",(e,t)=>{t.send("My page 2")}),x.get("/getfile1",(e,t)=>{console.log(e.query),t.send("My page 2")}),x.post("/getfile",(e,t)=>{d(e,t,(async function(r){if(r)return t.end("Error uploading file.");console.log("Call");var n=await f(`${e.file.originalname}`);return console.log("Result",n),t.download(n)}))}),x.get("*",(e,t)=>{t.send("My web page")});const y=process.env.PORT||3e3;x.listen(y)},function(e,t){e.exports=require("formidable")},function(e,t){e.exports=require("pretty-data")},function(e,t,r){"use strict";r.r(t),function(e){var t=r(1),n=r.n(t),a=r(10),o=r.n(a),i=(r(2),r(7)),l=r.n(i),c=(r(17),r(0)),s=r.n(c),u=(r(3),r(18)),f=2;async function p(e){return new Promise(t=>setTimeout(t,e))}async function d(e,t){var r=s.a.readFile("Extracted.xlsx"),a=r.Sheets["Extracted Data"];console.log(e);var i=new o.a.Parser;n.a.readFile(e,(async function(e,t){i.parseString(t,(async function(e,t){let o=JSON.stringify(t,null,2);n.a.writeFileSync("xml.json",o),n.a.writeFileSync("xml.txt",t),t.questionSet.question.forEach((async function(e){var t={LO:"",topic:"",AACSB:"",BB:"",FN:"",blooms:"",difficulty:"",time:""};t.title=e.title.toString(),e.categories.forEach((function(e){e.internal_category.forEach((function(e){var r=e.title.toString();r.includes("Learning Objective:")&&(""!==t.LO&&(t.LO+=", "),t.LO+=r.replace(/(.*)(\d{2,3})(-)(\d{2,3})(.*)/g,"$2$3$4")),r.includes("Topic:")&&(""!==t.topic&&(t.topic+=", "),t.topic+=r.replace(/Topic: /g,"")),r.includes("AACSB:")&&(""!==t.AACSB&&(t.AACSB+=", "),t.AACSB+=r.replace(/AACSB: /g,"")),r.includes("AICPA: BB")&&(""!==t.BB&&(t.BB+=", "),t.BB+=r.replace(/AICPA: BB /g,"")),r.includes("AICPA: FN")&&(""!==t.FN&&(t.FN+=", "),t.FN+=r.replace(/AICPA: FN /g,"")),r.includes("Blooms:")&&(""!==t.blooms&&(t.blooms+=", "),t.blooms+=r.replace(/Blooms: /g,"")),r.includes("Difficulty:")&&(""!==t.difficulty&&(t.difficulty+=", "),t.difficulty+=r.replace(/Difficulty: /g,"")),r.includes("Est Time:")&&(""!==t.time&&(t.time+=", "),t.time+=r.replace(/Est Time: /g,"")),r.includes("Type:")&&(""!==t.type&&(t.type+=", "),t.type+=r.replace(/Type: /g,"")),r.includes("Gradable:")&&(""!==t.gradable&&(t.gradable+=", "),t.gradable+=r.replace(/Gradable: /g,""))}))}));var r=[[`${t.title}`,`${t.LO}`,`${t.topic}`,`${t.AACSB}`,`${t.BB}`,`${t.FN}`,`${t.blooms}`,`${t.difficulty}`,`${t.time}`]];s.a.utils.sheet_add_aoa(a,r,{origin:`A${f}`}),f++})),await s.a.writeFile(r,"Extracted.xlsx"),console.log("Done")}))})),t("./Comparison.xlsx")}e.exports=async function(e){var t=new l.a(e).getEntries();for await(const e of t){if(await p(1e3),console.log(e.entryName),"xlsx"==e.entryName.split(".").pop()){var r=s.a.readFile(e.entryName),a=r.SheetNames[0],o=r.Sheets[a],i=s.a.readFile("ExcelTemplate.xlsx");s.a.utils.book_append_sheet(i,o,a);let t=JSON.stringify(s.a.utils.sheet_to_json(o),null,2);n.a.writeFileSync("PM.json",t),await s.a.writeFile(i,"Extracted.xlsx")}"xml"==e.entryName.split(".").pop()&&await d(e.entryName,(function(e){console.log(e)}))}await p(1e3),await u("Extracted.xlsx"),await p(1e3);var c=new l.a;return c.addLocalFile("./Comparison.xlsx"),c.addLocalFile("./Extracted.xlsx"),c.writeZip("./Output.zip"),await p(1e3),"./Output.zip"}}.call(this,r(8)(e))},function(e,t){e.exports=require("exceljs")},function(e,t,r){"use strict";r.r(t),function(e){var t=r(0),n=r.n(t),a=r(3),o=r.n(a),l=(r(1),r(2)),c=r.n(l);function s(e){var t=e.split(" ");return t[t.length-1]}function u(e){return/\d/g.test(e)}function f(e,t){var r={};for(t=(t=t.replace(/  +/g,",")).replace("\r\n",","),e=e.trim(),t=t.trim(),x=e.split(/[,;]/g).sort(),y=t.split(/[,;]/g).sort(),x=x.filter(Boolean),y=y.filter(Boolean),i=0;i<x.length;i++)x[i]=x[i].trim();for(i=0;i<x.length;i++)y[i]=y[i].trim();return x=x.sort(),y=y.sort(),r.extract=x.toString(),r.PM=y.toString(),r.Result=o.a.compareTwoStrings(x.toString(),y.toString()),r}function p(e,t){return f(e,t)}function d(e,t){return f(e,t)}function g(e,t){return f(e,t)}function m(e,t){return f(e,t)}function b(e,t){var r=e,n=t;return u(r)&&(r=s(r)),u(n)&&(n=s(n)),f(r,n)}function h(e,t){var r=e,n=t;return u(r)&&(r=s(r)),u(n)&&(n=s(n)),f(r,n)}function $(e,t){var r=e.match(/(\d{1,3})/g),n=t.match(/(\d{1,3})/g),a={};return a.extract=parseInt(r[r.length-1]),a.PM=parseInt(n[n.length-1]),a.Result=a.extract===a.PM?1:0,a}e.exports=async function(e){var t,r,a,o,i=new c.a.Workbook,l=i.createStyle({font:{color:"#000000",size:12},numberFormat:"$#,##0.00; ($#,##0.00); -"}),s=i.createStyle({font:{color:"#000000",size:12},fill:{type:"pattern",patternType:"solid",fgColor:"#FF0000"},numberFormat:"$#,##0.00; ($#,##0.00); -"}),u=i.addWorksheet("Comparison Result",{sheetFormat:{defaultColWidth:30}}),x=n.a.readFile("Extracted.xlsx"),y=x.Sheets["Extracted Data"],S=n.a.utils.sheet_to_json(y),P=x.Sheets.Sheet1,M=n.a.utils.sheet_to_json(P),v=2;for(let e of S){e.Q=e.Q.replace(/\[(.*)\]/g,"");var B=e.Q.match(/(\d{1,2}-\d{1,3})/g);B[0]=B[0].replace(/\b0+/g,"");for(let n of M){var w=n.Q.match(/(\d{1,2}-\d{1,3})/g);if(B[0]===w[0]){var A=(t=e.LO,r=n.LO,a=void 0,o=void 0,a=t.match(/(\d{1,2}-\d{1,3})/g),o=r.match(/(\d{1,2}-\d{1,3})/g),f(a.toString(),o.toString())),F=p(e.Topic,n.Topic),E=d(e.AACSB,n.AACSB),O=g(e.BB,n.BB),D=m(e.FN,n.FN),C=b(e.Blooms,n.Blooms),j=h(e.Difficulty,n.Difficulty),R=$(e.Time,n.Time);console.log(B[0],w[0]),u.cell(v,1).string(e.Q).style(l),u.cell(v,2).string(`Extracted Data: ${A.extract}\r\nProblem Map Data: ${A.PM}\r\nMatch: ${A.Result}`).style(A.Result>=.95?l:s),u.cell(v,3).string(`Extracted Data: ${F.extract}\r\nProblem Map Data: ${F.PM}\r\nMatch: ${F.Result}`).style(F.Result>=.95?l:s),u.cell(v,4).string(`Extracted Data: ${E.extract}\r\nProblem Map Data: ${E.PM}\r\nMatch: ${E.Result}`).style(E.Result>=.95?l:s),u.cell(v,5).string(`Extracted Data: ${O.extract}\r\nProblem Map Data: ${O.PM}\r\nMatch: ${O.Result}`).style(O.Result>=.95?l:s),u.cell(v,6).string(`Extracted Data: ${D.extract}\r\nProblem Map Data: ${D.PM}\r\nMatch: ${D.Result}`).style(D.Result>=.95?l:s),u.cell(v,7).string(`Extracted Data: ${C.extract}\r\nProblem Map Data: ${C.PM}\r\nMatch: ${C.Result}`).style(C.Result>=.95?l:s),u.cell(v,8).string(`Extracted Data: ${j.extract}\r\nProblem Map Data: ${j.PM}\r\nMatch: ${j.Result}`).style(j.Result>=.95?l:s),u.cell(v,9).string(`Extracted Data: ${R.extract}\r\nProblem Map Data: ${R.PM}\r\nMatch: ${R.Result}`).style(R.Result>=.95?l:s)}}v++}console.log("Comp St"),i.write("./Comparison.xlsx"),console.log("Comp End")}}.call(this,r(8)(e))}]);